<div align="center">
    <img src=https://raw.githubusercontent.com/senjianlu/sync-onenav-from-excel/master/logo.png width=15%/>
</div>

# sync-onenav-from-excel
å°† Excel ä¸­çš„ç½‘å€åŒæ­¥åˆ° OneNav ä¸€ä¸ºå¯¼èˆªä¸­ã€‚  
**âš ï¸ è¯¥è„šæœ¬ä»…é€‚ç”¨äº `V4.1810` å’Œå…¶å‰åæ²¡æœ‰æ•°æ®ç»“æ„å˜åŒ–çš„ç‰ˆæœ¬**ï¼

## äº‹å‰æé†’
### ä¸€ã€è¯¥è„šæœ¬åªå¯¹æ¥æºæ˜¯ Excel çš„ç½‘å€è¿›è¡ŒåŒæ­¥
å®ç°åŒºåˆ†æ¥æºçš„æ–¹æ³•æ˜¯ï¼šé¦–æ¬¡å°† Excel è¡¨æ ¼ä¸­çš„ç½‘å€å¯¼å…¥ OneNav æ—¶ï¼Œä¼šåœ¨ `wp_postmeta` è¡¨ä¸­æ·»åŠ  `meta_key` ä¸º `_sync_site_id` çš„è®°å½•ï¼Œè€Œå®ƒçš„å€¼ `meta_value` ä¸º Excel è¡¨æ ¼ä¸­è®¾å®šçš„ `è‡ªå®šä¹‰ ID`ã€‚  
è¿™äº›æ•°æ®åç»­å°±ä¼šè¢«åˆ¤æ–­ä¸ºæ¥æºäº Excel è¡¨æ ¼ã€‚  
**ä»»ä½•ä½ æ‰‹åŠ¨æ·»åŠ çš„ã€ä¸å­˜åœ¨ `_sync_site_id` æ•°æ®çš„ç½‘å€ï¼Œéƒ½ä¸ä¼šè¢«ä¿®æ”¹åˆ°**ã€‚  

### äºŒã€â­ è¯·åœ¨æ‰§è¡Œè„šæœ¬å‰å¤‡ä»½æ•´ç«™
è™½ç„¶æˆ‘å·²ç»å°½é‡ç¼©å°äº†å½±å“èŒƒå›´ï¼Œè„šæœ¬ä»…ä¼šæ“ä½œ `wp_posts`ã€`wp_postmeta`ã€`wp_term_taxonomy` å’Œ `wp_term_relationships` è¡¨ï¼Œä½†æ˜¯ä»ç„¶æ— æ³•ä¿è¯ 100% ä¸ä¼šå‡ºç°é¢„æƒ³å¤–çš„æƒ…å†µè€ŒæŸåä½ çš„ç«™ç‚¹æ•°æ®ã€‚  
**ä½ å¯ä»¥åœ¨ `å·¥å…·` -> `å¯¼å‡º` å¤„æ‰§è¡Œä¸‹è½½å¤‡ä»½çš„æ“ä½œ**ã€‚  

### ä¸‰ã€æœ‰é—®é¢˜å’Œå»ºè®®è¯·æäº¤ Issue
å¦‚æœä½ æœ‰å¥½çš„æƒ³æ³•ï¼Œå¯ä»¥æäº¤ [Issue](https://github.com/senjianlu/sync-onenav-from-excel/issues)ï¼Œæˆ‘ä¼šè€ƒè™‘æ·»åŠ åˆ°è„šæœ¬ä¸­ã€‚  
**å¦‚æœä½ å‘ç°äº† Bugï¼Œè¯·ä¸è¦æœ‰é¡¾è™‘ç›´æ¥æäº¤ Issue æˆ–æ˜¯åœ¨çº¿è”ç³»æˆ‘ï¼Œæˆ‘ä¼šå°½å¿«ä¿®å¤**ã€‚

## ä½¿ç”¨æ–¹æ³•
### ä¸€ã€å®‰è£… Python3
åœ¨ [Python å®˜ç½‘](https://www.python.org/) ä¸‹è½½å®‰è£…åŒ…ï¼Œå®‰è£…å¹¶å°† Python3 æ·»åŠ åˆ°ç¯å¢ƒå˜é‡ä¸­ã€‚  
å…·ä½“å¯ä»¥å‚è€ƒï¼š[Python3 ç¯å¢ƒæ­å»º](https://www.runoob.com/python3/python3-install.html)  

### äºŒã€ä¸‹è½½æºç 
å¦‚æœä½ å¯ä»¥è®¿é—® GitHubï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ `git clone` å‘½ä»¤ä¸‹è½½æºç ï¼š
```shell
git clone https://github.com/senjianlu/sync-onenav-from-excel.git
```
> å¦‚æœä½ å­˜åœ¨ç½‘ç»œé—®é¢˜ï¼Œé‚£ä¹ˆå¯ä»¥ä¸‹è½½å‹ç¼©åŒ…å¹¶è§£å‹ï¼š  
> ![ä¸‹è½½æºç å‹ç¼©åŒ…](https://image.senjianlu.com/blog/2024-10-14/193912.png)

### ä¸‰ã€å®‰è£…ä¾èµ–
åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹æ‰§è¡Œä»¥ä¸‹å‘½ä»¤å®‰è£…ä¾èµ–ï¼š
```shell
# è¿›å…¥é¡¹ç›®ç›®å½•
cd sync-onenav-from-excel
# å®‰è£… Python ä¾èµ–
pip3 install -r requirements.txt
# pip install -r requirements.txt
```
> å¦‚æœä½ å­˜åœ¨ç½‘ç»œé—®é¢˜ï¼Œé‚£ä¹ˆå¯ä»¥åˆ‡æ¢ä¸‹æºï¼Œå…·ä½“å¯ä»¥å‚è€ƒï¼š[pip ä½¿ç”¨å›½å†…é•œåƒæº](https://www.runoob.com/w3cnote/pip-cn-mirror.html)

### å››ã€ä¿®æ”¹é…ç½®æ–‡ä»¶
åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹æ‰¾åˆ° `config.ini` æ–‡ä»¶ï¼Œä¿®æ”¹å…¶ä¸­çš„é…ç½®ä¿¡æ¯ï¼Œä¸»è¦æ˜¯æ•°æ®åº“è¿æ¥å’Œå¯¼èˆªç«™åŸŸåï¼š
```ini
# MySQL è¿æ¥ä¿¡æ¯
[mysql]
host = "127.0.0.1"
port = "3306"
username = "root"
password = "myPasswordForMySQL"
database = "wordpress
```
```ini
# å¯¼èˆªç«™ä¿¡æ¯
[onenav]
# åŸŸå
domain = "https://steam.cash"
```

### äº”ã€æ‰“å¼€ Excel æ–‡ä»¶å¡«å…¥æ•°æ®
åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹æ‰¾åˆ° `OneNav å¯¼èˆªç«™æ•°æ®é›†.xlsx` æ–‡ä»¶ï¼Œæ‰“å¼€å¹¶å¡«å…¥æ•°æ®ã€‚  
è¯¦ç»†çš„å¡«å†™æ–¹æ³•å¯ä»¥å‚è€ƒ Excel ä¸­ã€Œä½¿ç”¨æ–¹æ³•ã€ï¼Œå®ƒæ€»æ˜¯æœ€æ–°çš„ï¼š  
![ä½¿ç”¨æ–¹æ³•](https://image.senjianlu.com/blog/2024-10-14/194501.png)

### å…­ã€æ‰§è¡Œè„šæœ¬
è¿›å…¥ `app` ç›®å½•ï¼Œæ‰§è¡Œ `main.py` è„šæœ¬ï¼š
```shell
cd app
# æ‰§è¡Œè„šæœ¬
python3 main.py
# python main.py
```
æˆ‘å°½é‡è®©è„šæœ¬çš„è¾“å‡ºè¶³å¤Ÿä¸°å¯Œï¼Œä»¥ä¾¿ä½ å¯ä»¥æ¸…æ¥šåœ°çŸ¥é“åœ¨å‘ç”Ÿä»€ä¹ˆï¼š  
![è¿è¡Œæˆªå›¾](https://image.senjianlu.com/blog/2024-10-14/195105.png)

### ä¸ƒã€æŸ¥çœ‹ç»“æœ
ä¹‹åå›åˆ°ä½ çš„å¯¼èˆªç«™ç‚¹ï¼Œåˆ·æ–°é¡µé¢ï¼Œåº”è¯¥å°±å¯ä»¥çœ‹åˆ°å¯¹åº”çš„ä¿®æ”¹ç”Ÿæ•ˆäº† ğŸ‰ã€‚


## å®ç°æµç¨‹
1. è¯»å– Excel æ–‡ä»¶
2. è§£æ Excel æ–‡ä»¶è·å– `ç½‘å€`
3. æŸ¥è¯¢ OneNav æ•°æ®åº“ï¼Œè·å–å½“å‰å­˜åœ¨çš„ `ç½‘å€`
4. å¯¹æ¯”ä»¥æ‰¾å‡ºéœ€è¦æ–°å¢ã€åˆ é™¤ã€ä¿®æ”¹çš„ `ç½‘å€`
5. æ‰§è¡Œæ–°å¢ã€åˆ é™¤ã€ä¿®æ”¹æ“ä½œ

## åŠŸèƒ½åˆ—è¡¨
- âœ… `ç½‘å€` `site`  
    - âœ… å¢åŠ  (insert)  
    - âœ… åˆ é™¤ (delete)  
    - âœ… ä¿®æ”¹ (update)  
    - âœ… æŸ¥è¯¢ (select)  
- â¬œ `ç½‘å€åˆ†ç±»` `favorite`  
    - â¬œ å¢åŠ  (insert)
    - â¬œ åˆ é™¤ (delete)
    - â¬œ ä¿®æ”¹ (update)
    - âœ… æŸ¥è¯¢ (select)
    - â¬œ å±•ç¤º (show)
- â¬œ `ç½‘å€æ ‡ç­¾` `tag`  
    - â¬œ å¢åŠ  (insert)
    - â¬œ åˆ é™¤ (delete)
    - â¬œ ä¿®æ”¹ (update)
    - âœ… æŸ¥è¯¢ (select)
    - â¬œ å±•ç¤º (show)
- â¬œ å°†ç»“æœæ›´æ–°å› Excel è¡¨ä¸­


## æ›´å¤šæ–‡ç« 
ä½ å¯ä»¥åœ¨æˆ‘çš„[åšå®¢](https://senjianlu.com)ä¸­æ‰¾åˆ°æ•°ç¯‡ä¸ [OneNav ç›¸å…³çš„æ–‡ç« ](https://senjianlu.com/tags/steam-cash/)ï¼Œå¦‚æœä½ æƒ³äºŒå¼€ï¼Œå®ƒä»¬åº”è¯¥ä¼šå¯¹ä½ æœ‰æ‰€å¸®åŠ©ã€‚
- [ä½¿ç”¨ Docker éƒ¨ç½² MySQL + WordPress å¹¶å®‰è£… OneNav ä¸€ä¸ºå¯¼èˆª](https://senjianlu.com/2024/10/10/docker_mysql_wordpress_onenav/)
- [OneNav ä¸€ä¸ºå¯¼èˆªæ–°å»ºç›®å½•ä¸å¯¼èˆªç½‘å€](https://senjianlu.com/2024/10/11/wordpress_onenav_add_link/)
- â­ [WordPress è¡¨ç»“æ„æè¿°ä¸ OneNav ä¸€ä¸ºå¯¼èˆªæ–°å»ºç½‘å€å®é™…ç”Ÿæˆçš„è¡¨æ•°æ®](https://senjianlu.com/2024/10/12/wordpress_data_modeler_onenav/)
- [OneNav ä¸€ä¸ºå¯¼èˆªé€šè¿‡ Python3 è„šæœ¬å®ç°ç½‘å€çš„å¢åˆ æ”¹æŸ¥](https://senjianlu.com/2024/10/12/onenav_python3_site_crud/)